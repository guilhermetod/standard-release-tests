name: Pull request

on: 
  pull_request:
    branches: [main, devel]

jobs: 
  draft_release:
    env:
      GITHUB_ACTIONS: false
    runs-on: ubuntu-latest
    name: Draft release
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - name: Install dependencies
        run: npm ci
      - name: Echo current branch
        run: |
          echo $GITHUB_HEAD_REF
          echo $GITHUB_BASE_REF
          echo $GITHUB_REF
          echo $(git branch --show-current)
      - name: Checkout branch
        run: git checkout $GITHUB_HEAD_REF
      - name: Create draft
        id: build-release-notes
        uses: ./
      - name: Comment standard-version preview
        uses: peter-evans/create-or-update-comment@v1
        with:
          issue-number: ${{ github.event.number }}
          body: |
            Hey ðŸ‘‹!
            This is a preview of your release notes, based on your commits.
            In case you want to change it, you can rebase and adjust your commit messages according to [conventional commits](https://www.conventionalcommits.org/).
            ${{ steps.build-release-notes.outputs.releaseNotes }}

